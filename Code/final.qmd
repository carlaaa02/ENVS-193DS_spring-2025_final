---
title: "final"
format: html
editor: visual
---

\[Github Repo\]()

## set up

```{r}
#load packages and reading data
library(tidyverse)
library(janitor)
library(lubridate)
library(dplyr)
library(ggplot2)

#reading csv data file 
sst <- read.csv("Data/SST_sb_channel.csv")

```

## Problem 1. Research Writing

### a. Transparent statistical methods

In part 1, they used a correlation test. They most likely used Pearson correlation test since both variables are continuous and they are assessing the linear relationship between distance from headwater and annual total nitrogen load. But there is not enough information to confidently determine if they used Pearson or Spearman correlation test.

In part 2, they used one-way ANOVA. They compared the average in nitrogen load (mean) with 5 variables. ANOVA test is used to test for statistical significant differences between the means of 2 or more groups.

### b. More information needed

-   Summary statistics

    adding summary statistics like the mean, standard deviation and sample size can helps us understand the magnitud and variability of the nitrogen loads for each source. For example the mean would gives us information about how much each source contributes.

-   Performing Tukey HSD

    This test would help us identify which nitrogen sources is significantly different when we compare them since ANOVA tells us there is significant difference but not from which sources, this test would helps us identify that.

### c. Suggestion for rewriting

Part 1:

We found a statistically significant positive relationship between distance from headwater and total nitrogen load, suggesting that nitrogen accumulates downstream, possibly due to agricultural and urban inputs.\
(Pearson correlation test: r = \[correlation coefficient\], p = 0.03, α = 0.05)

Part 2:

Average nitrogen load differed significantly among the five nitrogen sources, indicating that some sources contribute more nitrogen than others.(One-way ANOVA: F = \[F statistic\], df = \[degrees of freedom\], p = 0.02, α = 0.05).

## Problem 2. Data visualization

### a. cleaning and summarizing 

```{r}
#creating new object for clean data
sst_clean <- sst |> 
  mutate(date = ymd(date)) |> # convert data column into different data format 
  mutate(
    year = year(date), #extracting year and data
    month = month(date, label = TRUE)  #use abbreviated month labels
  ) |> 
  #Filter for the years needed for the figure   (2018–2023)
  filter(year >= 2018, year <= 2023) |> 
  #Group by year and month
  group_by(year, month) |> 
  #Summarizing data by calculating the mean sst for each year-month
  summarise(
    mean_monthly_sst = mean(temp, na.rm = TRUE),
    .groups = "drop"
  )

#display 5 random rows from the cleaned dataset
slice_sample(sst_clean, n = 5)
str(sst_clean)
```

### b. Visualize the data 

```{r}
# creating the plot
ggplot(sst_clean, aes(x = month, y = mean_monthly_sst, group = factor(year), color = factor(year))) + 
  geom_line(size = 1) + # adding line geometry
  geom_point(size = 2) + # adding point geometry
  scale_color_manual(
    values = colorRampPalette(c("yellow", "red"))(6), #yellow to red color gradient
    name = "Year"
  ) +
  labs(  
    x = "Month", # x-label
    y = "Mean monthly sea surface temperature (°C)" # y-label
  ) +
  theme_minimal(base_size = 14) + #clean base theme
  theme(
    panel.border = element_rect(color = "gray", fill = NA, size = 1), #adding panel border
    panel.background = element_blank(), #blank background
    legend.position = c(0.11, 0.8),   #adding legend inside the panel
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 10),
    panel.grid = element_blank(), # getting rid of grid lines
    axis.ticks.length = unit(0.1, "cm"),  #adding tick marks outside
    axis.ticks = element_line(color = "black") #black tick marks
  )

```
